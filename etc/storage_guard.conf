# /etc/storage_guard.conf
# Storage Guard main configuration file
# Lines starting with '#' are comments.

[general]
# Logging settings
log_level = INFO              # DEBUG / INFO / WARN / ERROR
log_file  = /var/log/storage_guard.log
syslog_on_error = yes         # yes = also send ERROR logs to syslog

# Monitoring settings
check_interval = 30           # seconds between checks
threshold_trigger = 3         # number of consecutive exceedances before action
kill_on_hard_limit = yes      # kill active sessions when hard limit exceeded
use_threads = yes             # yes = thread pool enabled
max_threads = 16              # number of worker threads
use_connection_pool = yes     # maintain persistent pool
connection_pool_size = 10     # pool size
user_limits_file = /etc/storage_guard_users.conf

# Prometheus metrics
metrics_file = /var/lib/storage_guard/metrics.prom
metrics_buffer_size = 8192    # buffer size in bytes

# Schema patterns: use "%s" placeholder for username
# Multiple patterns separated by comma
schema_patterns = %s,%s_logs

# External user limits file (optional)
user_limits_file = /etc/storage_guard_users.conf

# Drop privileges to this user/group after start
daemon_user = storageguard
daemon_group = storageguard


[database]
# DB connection settings
type = mysql                  # mysql / mariadb
host = 127.0.0.1
port = 3306
user = root
password_file = /root/etc/storage_guard_db.pass

#[limits]
# Inline user limits (username = soft_limit_bytes , hard_limit_bytes)
# Example: soft = 1 GB, hard = 2 GB
#user1 = 1073741824 , 2147483648
#user2 = 2147483648 , 3221225472
